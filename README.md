#  ì¥ë©´ íƒìƒ‰ì„ ìœ„í•œ Video to Text / Text to Frame ëª¨ë¸

## ğŸ¥‡ íŒ€ êµ¬ì„±ì›
<table>
    <tr>
        <th align="center"><a href="https://github.com/DrunkLee">ì´ìƒì§„</a></th>
        <th align="center"><a href="https://github.com/youhs1125">ìœ í¬ì„</a></th>
        <th align="center"><a href="https://github.com/JJhun26">ì •ì§€í›ˆ</a></th>
        <th align="center"><a href="https://github.com/chunyudong">ì²œìœ ë™</a></th>
        <th align="center"><a href="https://github.com/subsup98">ì„ìš©ì„­</a></th>
        <th align="center"><a href="https://github.com/ssujaewoo">ë°•ì¬ìš°</a></th>
    </tr>
    <tr>
        <td align="center"><img src="https://github.com/user-attachments/assets/a95e8208-6cd7-4e9e-8268-1bc696bd56f7" width="100"></td>
        <td align="center"><img src="https://github.com/user-attachments/assets/328adcf5-4a22-48d6-983c-732202b529b0" width="100"></td>
        <td align="center"><img src="https://github.com/user-attachments/assets/c813d969-5442-4a52-80c4-f00d26dcd379" width="100"></td>
        <td align="center"><img src="https://github.com/user-attachments/assets/8d5fdffb-a81a-4da6-8c70-35b4d8402264" width="100"></td>
        <td align="center"><img src="https://github.com/user-attachments/assets/153869a0-abe4-4892-96aa-875a496f296d" width="100"></td>
        <td align="center"><img src="https://github.com/user-attachments/assets/c03fb329-2690-493c-9e01-4ef03dbb3d17" width="100"></td>
    </tr>
    <tr>
    <td align="center">
        <strong>ğŸ‘‘ íŒ€ì¥</strong><br>
        <small>ğŸ”¹ Video 2 Text</small><br>
        <small>ğŸ”¹ VLM Fine-Tuning</small><br>
        <small>ğŸ”¹ ìµœì í™”</small><br>
        <small>ğŸ”¹ Prompt Engineering</small><br>
        <small>ğŸ”¹ Streamlit</small>
    </td>
    <td align="center">
        <small>ğŸ”¹ Video 2 Text</small><br>
        <small>ğŸ”¹ VLM Fine-Tuning</small><br>
        <small>ğŸ”¹ Data Cleansing</small><br>
        <small>ğŸ”¹ Data Labeling</small><br>
        <small>ğŸ”¹ ìµœì í™”</small>
    </td>
    <td align="center">
        <small>ğŸ”¹ Text 2 Frame</small><br>
        <small>ğŸ”¹ Translation</small><br>
        <small>ğŸ”¹ Data Cleansing</small><br>
        <small>ğŸ”¹ Backend</small>
    </td>
    <td align="center">
        <small>ğŸ”¹ Text 2 Frame</small><br>
        <small>ğŸ”¹ VLM Test</small><br>
        <small>ğŸ”¹ Data Cleansing</small><br>
        <small>ğŸ”¹ Data Labeling</small>
    </td>
    <td align="center">
        <small>ğŸ”¹ Text 2 Frame</small><br>
        <small>ğŸ”¹ Backend</small><br>
        <small>ğŸ”¹ Streamlit</small><br>
        <small>ğŸ”¹ VLM Fine-Tuning</small>
    </td>
    <td align="center">
        <small>ğŸ”¹ Video 2 Text</small><br>
        <small>ğŸ”¹ VLM Test</small><br>
        <small>ğŸ”¹ Audio</small><br>
        <small>ğŸ”¹ Transcription</small>
    </td>
</tr>

</table>



## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •
2025.01.10(ê¸ˆ) ~ 2025.02.12(ìˆ˜)

## ğŸ” í”„ë¡œì íŠ¸ ì†Œê°œ
ë³¸ í”„ë¡œì íŠ¸ëŠ” `ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech` ì—ì„œ ì§„í–‰í•œ í•´ì»¤í†¤ ì£¼ì œ ì¤‘ í•˜ë‚˜ì¸ `TVING`ì˜ **ì¥ë©´ íƒìƒ‰ì„ ìœ„í•œ Video-to-Text & Text-to-Frame** ì£¼ì œ ì…ë‹ˆë‹¤.

ë¹„ë””ì˜¤ íƒìƒ‰ì„ ìœ„í•œ **Video-to-Text ë° Text-to-Frame ëª¨ë¸**ì„ êµ¬ì¶•í•˜ì—¬, ë¹„ë””ì˜¤ ë‚´ìš©ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ê³ , **íŠ¹ì • í…ìŠ¤íŠ¸ì™€ ê°€ì¥ ì¼ì¹˜í•˜ëŠ” ì¥ë©´**ì„ ì°¾ì•„ì£¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“Š ë°ì´í„°ì…‹
- Youtube-8M (`Tag : Movieclips`)
- Movie Clips ì´ ë¹„ë””ì˜¤ ê°œìˆ˜ : `1683ê°œ`
- Movie Clips ì ‘ê·¼ ê°€ëŠ¥ ê°œìˆ˜ : `1216ê°œ`
- **ìº¡ì…˜ ì •ë³´ ì—†ìŒ**

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

<details>
<summary><span style="font-size: 20px; font-weight: bold">Project Structure</span></summary>

```plaintext
ğŸ“¦ project-root
â”œâ”€â”€ ğŸ“„ README.md
â”œâ”€â”€ 
â”œâ”€â”€ ğŸ“ final_project
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“œ main.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ distribute
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ flask_video_processor.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ mainserver_flask.py
â”‚   â”‚   â””â”€â”€ ğŸ“œ subserver_flask.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ models
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ add_embedding.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ analyze.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ angle_similarity.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ audio_model.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ clip_similarity.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ frame_extract.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ translation.py
â”‚   â”‚   â””â”€â”€ ğŸ“œ video_processor.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ modules
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ flask_video_preprocess.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ text_to_frame.py
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ video_preprocess.py
â”‚   â”‚   â””â”€â”€ ğŸ“œ video_to_text.py
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“œ requirements.txt
â”‚   â””â”€â”€ ğŸ› ï¸ setup.sh
â”‚   
â”œâ”€â”€ ğŸ“ lora_train_json
â”‚   â”œâ”€â”€ ğŸ“œ test_split.jsonl
â”‚   â”œâ”€â”€ ğŸ“œ train_split.jsonl
â”‚   â””â”€â”€ ğŸ“œ val_split.jsonl
â”‚   
â”œâ”€â”€ ğŸ“ model_test
â”‚   â”œâ”€â”€ ğŸ“œ CogVLM2-llama2-caption.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ InternVL2.5-8B-MPO.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ InternVideo2-chat-8B.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ LLaVA-NeXt-Video-7B-hf.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ LLaVA-Video-7B-Qwen2.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ LongVU_Qwen2_7B.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ qwen2_test.ipynb
â”‚   â”œâ”€â”€ ğŸ“œ videoMAE2-giant.ipynb
â”‚   â””â”€â”€ ğŸ“œ blip.ipynb
â”‚   
â”œâ”€â”€ ğŸ“ utils
â”‚   â”œâ”€â”€ ğŸ“œ Pseudo_labeling.py
â”‚   â”œâ”€â”€ ğŸ“œ scene_split.py
â”‚   â””â”€â”€ ğŸ“œ split_videos.ipynb
â”‚   
â””â”€â”€ ğŸ“ wrap_up_report
    â””â”€â”€ ğŸ“œ ìµœì¢…_ë³´ê³ ì„œ_CV_í”„ë¡œì íŠ¸(11ì¡°).pdf
```

</details>

## âš™ï¸ Settings
ë³¸ í”„ë¡œì íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í™˜ê²½ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **ìš´ì˜ì²´ì œ** : `Linux`
- **GPU** : `Tesla V100 32GB`
- **PyTorch** : `2.1.0`
- **CUDA** : `11.8`
- **cuDNN** : `8.7.0`
- **NVCC** : `11.8`
- **Python** : `3.10`

### ğŸ”§ Setup
ì¶”ë¡ ì— í•„ìš”í•œ `LoRA Weight`ì™€ `.NPZ DB`, íŒ¨í‚¤ì§€ë“¤ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.
``` bash
chmod +x setup.sh
sh setup.sh
```

### ğŸš€ Streamlit
```bash
streamlit run main.py
```
## ğŸ›  ì‚¬ìš© ë°©ë²•
### 1. Streamlit
<p>
<img src="https://github.com/user-attachments/assets/80944e5e-7a67-4501-8800-efb1ab5b750a">
</p>
ì»¤ë§¨ë“œ ì°½ì„ ì´ìš©í•´ streamlitì„ ì‹¤í–‰ì‹œì¼œ ì¤ë‹ˆë‹¤.

### 2. Video to Text
<p>
<img src="https://github.com/user-attachments/assets/4ac4c52c-2b53-4989-b77c-0c1fd9c03a04">
</p>

1. ì¶”ë¡ í•˜ê³  ì‹¶ì€ íŒŒì¼ì„ ìŠ¤íŠ¸ë¦¼ë¦¿ì— ì˜¬ë ¤ì¤ë‹ˆë‹¤.

2. ìŠ¬ë¼ì´ë“œë°”ë¥¼ ì´ìš©í•˜ì—¬ ë¹„ë””ì˜¤ë¥¼ ì˜ë¼ì¤ë‹ˆë‹¤.

3. ì¶”ë¡  ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤

### 3. Video Preprocess
<p>
<img src="https://github.com/user-attachments/assets/b3cacc4e-4da3-4fe9-80ce-7e60160f2ff6">
</p>

1. VectorDBì— ì €ì¥í•  ìƒˆë¡œìš´ ë¹„ë””ì˜¤ 10ê°œë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.

<p>
<img src="https://github.com/user-attachments/assets/8bfd0bab-7ab6-4462-bc31-0786b3288111">
</p>

2. ìŠ¤íŠ¸ë¦¼ë¦¿ì— ë™ì˜ìƒì´ ëª¨ë‘ ë¡œë“œ ë˜ë©´ 'ë¹„ë””ì˜¤ í”„ë¡œì„¸ì‹± ì‹œì‘'ì´ë¼ëŠ” ë²„íŠ¼ì´ ë‚˜íƒ€ë‚˜ë©° í”„ë¡œì„¸ì‹±ì„ ì‹œì‘í•©ë‹ˆë‹¤, ìµœëŒ€ 10ë¶„ ê°€ëŸ‰ ê±¸ë¦¬ëŠ” ì‘ì—…ì´ë‹ˆ ì¸ë‚´ì‹¬ì„ ê°€ì§€ê³  ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!

<p>
<img src="https://github.com/user-attachments/assets/123f7a21-f687-4396-aae7-3adc12ef9779">
</p>

3. í”„ë¡œì„¸ì‹±ì´ ë§ˆë¬´ë¦¬ë˜ë©´ 'ëª¨ë“  ë¹„ë””ì˜¤ì˜ ì „ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!' ë¼ëŠ” ë¬¸êµ¬ì™€ í•¨ê»˜ VectorDBì— ì…ë ¥ìœ¼ë¡œ ë“¤ì–´ì˜¨ ë¹„ë””ì˜¤ ì„ë² ë”©ì´ ì €ì¥ë©ë‹ˆë‹¤!

### 4. Text to Frame

<p>
<img src="https://github.com/user-attachments/assets/97d3413f-f599-43e0-966c-ded520b6a0a1">
</p>

ì°¾ê³  ì‹¶ì€ ì˜ìƒì˜ ì„¤ëª…ì„ í•œê¸€ë¡œ ì‘ì„± í›„ 'í”„ë ˆì„ ì¶”ì¶œ' ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ì ì‹œ ë’¤ VectorDBì—ì„œ ìœ ì‚¬ë„ë¥¼ ê²€ì‚¬í•˜ì—¬ Top 5ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤!


## :computer:ì„œë¹„ìŠ¤ ì•„í‚¤í…ì³
![image](https://github.com/user-attachments/assets/06bf1ad7-9145-4d8e-a342-f1840cbef735)



# LoRA Weight File Link
[LoRA_Weight](https://drive.google.com/file/d/1ZAWyN1aPXgWKbyCACnHz8LS9qE8Wqs7B/view?usp=drive_link)

# Youtube-8M Movie Clip AnglE features
[movie_clip_AnglE_UAE_Large_V1_features](https://drive.google.com/file/d/1mwfAh37wVEA3hJCLs1eXDjTe9vElefxB/view?usp=drive_link)
